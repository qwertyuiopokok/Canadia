<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Canadia ‚Äî Comprendre. Structurer. D√©cider.</title>
    <style>
        :root {
            --primary: #d32f2f;     /* Rouge canadien */
            --secondary: #f44336;
            --bg: #ffffff;
            --surface: #f8f9fa;
            --text: #212121;
            --muted: #666666;
        }
        <!DOCTYPE html>
        <html lang="fr">
        <head>
            <meta charset="UTF-8" />
            <meta name="viewport" content="width=device-width, initial-scale=1.0" />
            <title>Canadia ‚Äî Comprendre. Structurer. D√©cider.</title>
            <style>
                :root {
                    --primary: #d32f2f;
                    --secondary: #f44336;
                    --accent: #ffeb3b;
                    --bg: #ffffff;
                    --surface: #f8f9fa;
                    --text: #212121;
                    --muted: #666666;
                }
                body.dark {
                    --bg: #121212;
                    --surface: #1e1e1e;
                    --text: #f5f5f5;
                    --muted: #aaaaaa;
                }
                body {
                    margin: 0;
                    font-family: system-ui, -apple-system, sans-serif;
                    background: var(--bg);
                    color: var(--text);
                    min-height: 100vh;
                    display: flex;
                    flex-direction: column;
                    transition: all 0.3s;
                }
                header {
                    background: var(--primary);
                    color: white;
                    padding: 2rem 1rem;
                    text-align: center;
                }
                .title { font-size: 2.8rem; font-weight: 700; margin: 0; }
                .subtitle { font-size: 1.2rem; opacity: 0.9; margin: 0.5rem 0 2rem; }
                .mode-selector { display: flex; justify-content: center; gap: 1rem; flex-wrap: wrap; }
                .mode-btn {
                    padding: 0.8rem 2rem; background: rgba(255,255,255,0.2); border: none; border-radius: 50px;
                    color: white; font-size: 1.1rem; cursor: pointer; transition: all 0.3s;
                }
                .mode-btn.active { background: white; color: var(--primary); font-weight: 600; }
                main { flex: 1; display: flex; flex-direction: column; align-items: center; padding: 2rem; }
                .search-container { width: 100%; max-width: 800px; text-align: center; }
                .search-box {
                    width: 100%; padding: 1.5rem 2rem; font-size: 1.4rem; border: 4px solid var(--secondary);
                    border-radius: 50px; background: var(--surface); color: var(--text);
                    box-shadow: 0 10px 30px rgba(0,0,0,0.1); outline: none;
                }
                .search-box:focus { border-color: var(--accent); }
                .search-btn {
                    margin-top: 2rem; padding: 1.2rem 4rem; font-size: 1.3rem; background: var(--primary);
                    color: white; border: none; border-radius: 50px; cursor: pointer;
                    box-shadow: 0 8px 25px rgba(211,47,47,0.3); transition: all 0.3s;
                }
                .search-btn:hover { background: var(--secondary); }
                #theme-toggle { position: absolute; top: 1.5rem; right: 1.5rem; background: none; border: none; font-size: 1.8rem; cursor: pointer; color: white; }
                .hint { margin-top: 1.5rem; font-size: 1.1rem; color: var(--muted); }
                #loader { text-align: center; margin: 3rem; color: var(--muted); font-size: 1.4rem; display: none; }
                #results {
                    width: 100%; max-width: 800px; margin-top: 3rem; padding: 2rem;
                    background: var(--surface); border-radius: 16px; box-shadow: 0 8px 30px rgba(0,0,0,0.1);
                    line-height: 1.6;
                }
                #results h2 { color: var(--primary); margin-top: 0; }
                #results strong { color: var(--primary); }
                #results ul { padding-left: 1.5rem; }
                #results li { margin-bottom: 0.5rem; }
            </style>
        </head>
        <body>
            <header>
                <button id="theme-toggle" aria-label="Th√®me sombre/clair">üåô</button>
                <h1 class="title">Canadia</h1>
                <p class="subtitle">Comprendre. Structurer. D√©cider.</p>
                <div class="mode-selector">
                    <button class="mode-btn active" onclick="setMode('citizen')">Citoyen</button>
                    <button class="mode-btn" onclick="setMode('student')">√âtudiant</button>
                    <button class="mode-btn" onclick="setMode('pro')">Entreprise</button>
                </div>
            </header>

            <main>
                <div class="search-container">
                    <input type="text" class="search-box" id="query" placeholder="Posez votre question ici..." onkeypress="handleEnter(event)" />
                    <p class="hint" id="mode-hint">Recherche g√©n√©rale pour tous les citoyens</p>
                    <button class="search-btn" onclick="ask()">Rechercher</button>
                </div>

                <div id="loader">Canadia r√©fl√©chit... ‚è≥</div>

                <div id="results"></div>
            </main>

            <script>
                let currentMode = 'citizen';
                const hints = {
                    citizen: "Recherche g√©n√©rale pour tous les citoyens",
                    student: "Analyse adapt√©e au contexte universitaire et √©tudiant",
                    pro: "Analyse strat√©gique pour entreprises et organisations"
                };

                function setMode(mode) {
                    currentMode = mode;
                    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
                    event.target.classList.add('active');
                    document.getElementById('mode-hint').textContent = hints[mode];
                }

                function handleEnter(e) {
                    if (e.key === 'Enter') ask();
                }

                async function ask() {
                    const query = document.getElementById('query').value.trim();
                    if (!query) return alert('Entrez une question !');

                    document.getElementById('loader').style.display = 'block';
                    document.getElementById('results').style.display = 'none';

                    try {
                        // √Ä ADAPTER quand backend en ligne : changer l'URL (ex. https://ton-backend.com/${currentMode}/ask)
                        const res = await fetch(`http://127.0.0.1:9000/${currentMode}/ask`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ question: query })
                        });

                        if (!res.ok) throw new Error('Erreur serveur');

                        const data = await res.json();

                        let html = '<h2>R√©ponse de Canadia</h2>';
                        if (data.title) html += `<strong>üß† ${data.title}</strong><br><br>`;
                        if (data.summary) html += `<strong>R√©sum√© :</strong><br>${data.summary}<br><br>`;
                        if (data.key_points?.length) html += `<strong>Points cl√©s :</strong><ul><li>${data.key_points.join('</li><li>')}</li></ul><br>`;
                        if (data.analysis) html += `<strong>Analyse :</strong><br>${data.analysis}<br><br>`;
                        if (data.actions_or_reflections?.length) html += `<strong>Pour aller plus loin :</strong><ul><li>${data.actions_or_reflections.join('</li><li>')}</li></ul><br>`;
                        if (data.sources?.length) html += `<strong>Sources :</strong><ul><li>${data.sources.join('</li><li>')}</li></ul><br>`;
                        if (data.limits) html += `<strong>Limites :</strong><br>${data.limits}<br><br>`;
                        if (data.disclaimer) html += `<em>${data.disclaimer}</em>`;

                        document.getElementById('results').innerHTML = html || 'Aucune r√©ponse structur√©e.';
                        document.getElementById('results').style.display = 'block';
                    } catch (err) {
                        document.getElementById('results').innerHTML = `<strong style="color:red;">Erreur :</strong> ${err.message}<br><br>Le backend n'est pas accessible (normal si pas lanc√© localement ou h√©berg√©).`;
                        document.getElementById('results').style.display = 'block';
                    } finally {
                        document.getElementById('loader').style.display = 'none';
                        document.getElementById('query').value = '';
                    }
                }

                document.getElementById('theme-toggle').onclick = () => {
                    document.body.classList.toggle('dark');
                    const isDark = document.body.classList.contains('dark');
                    localStorage.setItem('theme', isDark ? 'dark' : 'light');
                    document.getElementById('theme-toggle').textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
                };
                if (localStorage.getItem('theme') === 'dark') {
                    document.body.classList.add('dark');
                    document.getElementById('theme-toggle').textContent = '‚òÄÔ∏è';
                }
            </script>
        </body>
        </html>

        .diagnostic button:hover {
            background: #218838;
        }

        /* Canadia Pro Analyse Strat√©gique Styles */
        .ask-pro {
            background: white;
            border-radius: 6px;
            padding: 1rem;
            margin-top: 2rem;
            border-left: 4px solid #17a2b8;
        }

        .ask-pro h2 {
            margin-top: 0;
        }

        .ask-pro textarea {
            width: 100%;
            padding: 0.5rem;
            margin-bottom: 1rem;
            border: 1px solid #ccc;
            border-radius: 4px;
            height: 100px;
        }

        .ask-pro button {
            background: #17a2b8;
            color: white;
            border: none;
            padding: 0.7rem;
            border-radius: 4px;
            cursor: pointer;
        }

        .ask-pro button:hover {
            background: #138496;
        }

        /* Canadia Pro R√©sultat d'Analyse Strat√©gique Styles */
        .pro-result {
            background: white;
            border-radius: 6px;
            padding: 1rem;
            margin-top: 2rem;
            border-left: 4px solid #ffc107;
        }

        .pro-result h2 {
            margin-top: 0;
        }

        .pro-result ol {
            margin: 0;
            padding-left: 1.5rem;
        }

        .pro-result li {
            margin-bottom: 0.5rem;
        }

        .pro-answer {
            background: #f8f9fa;
            border: 1px solid #ced4da;
            border-radius: 4px;
            padding: 0.5rem;
            margin-top: 1rem;
        }

        /* Canadia Pro Exemple de R√©ponse Structur√©e Styles */
        .response {
            background: #e9ecef;
            border-radius: 6px;
            padding: 1rem;
            margin-top: 2rem;
            border-left: 4px solid #007bff;
        }

        .response h3 {
            margin-top: 0;
        }

        .response ul {
            margin: 0;
            padding-left: 1.5rem;
        }

        .response li {
            margin-bottom: 0.5rem;
        }

        /* Canadia Pro Plan d‚ÄôAction Propos√© Styles */
        .action-plan {
            background: white;
            border-radius: 6px;
            padding: 1rem;
            margin-top: 2rem;
            border-left: 4px solid #dc3545;
        }

        .action-plan h2 {
            margin-top: 0;
        }

        .action-plan ol {
            margin: 0;
            padding-left: 1.5rem;
        }

        .action-plan li {
            margin-bottom: 0.5rem;
        }

        /* Canadia Pro Historique Styles */
        .history {
            background: white;
            border-radius: 6px;
            padding: 1rem;
            margin-top: 2rem;
            border-left: 4px solid #6c757d;
        }

        .history h2 {
            margin-top: 0;
        }

        .history ul {
            margin: 0;
            padding-left: 1.5rem;
        }

        .history li {
            margin-bottom: 0.5rem;
        }

        /* Disclaimer Styles */
        .disclaimer {
            display: block;
            margin-top: 2rem;
            font-size: 0.8rem;
            color: #666;
            text-align: center;
        }
    </style>
</head>
<body>

<header>
    <h1>Canadia</h1>
    <p>Actualit√©s citoyennes du jour</p>
</header>

<main>
    <label for="province-select">Province :</label>
    <select id="province-select">
      <option value="QC">Qu√©bec</option>
      <option value="ON">Ontario</option>
      <option value="BC">Colombie-Britannique</option>
    </select>
    <div id="news-container" class="loading">
        Chargement des actualit√©s‚Ä¶
    </div>

    <!-- Canadia Pro Dashboard Section -->
    <section class="dashboard">
      <h2>Bienvenue sur Canadia Pro</h2>
      <div class="cards">
        <div class="card">
          <h3>Structure actuelle</h3>
          <p>Organisation fonctionnelle ‚Äì 12 employ√©s</p>
        </div>
        <div class="card">
          <h3>Probl√®mes d√©tect√©s</h3>
          <p>Communication interne, priorit√©s floues</p>
        </div>
        <div class="card">
          <h3>Derni√®re analyse</h3>
          <p>Il y a 3 jours</p>
        </div>
      </div>
    </section>

    <!-- Canadia Pro Diagnostic Section -->
    <section class="diagnostic">
      <h2>Diagnostic organisationnel</h2>
      <label>
        Quelle est la taille de votre entreprise ?
        <select>
          <option>1‚Äì5</option>
          <option>6‚Äì20</option>
          <option>21‚Äì100</option>
          <option>100+</option>
        </select>
      </label>
      <label>
        Quels sont vos principaux d√©fis actuels ?
        <textarea></textarea>
      </label>
      <button>Continuer</button>
    </section>

    <!-- Canadia Pro Analyse Strat√©gique Section -->
    <section class="ask-pro">
      <h2>Analyse strat√©gique</h2>
      <p><strong>Contexte entreprise :</strong> PME ‚Äì services ‚Äì Qu√©bec</p>
      <textarea placeholder="D√©crivez votre situation ou votre question..."></textarea>
      <button>Analyser</button>
    </section>

    <!-- Canadia Pro R√©sultat d'Analyse Strat√©gique Section -->
    <section class="pro-result">
      <h2>R√©sultat de l‚Äôanalyse</h2>
      <ol>
        <li><strong>Diagnostic</strong></li>
        <li><strong>Hypoth√®ses</strong></li>
        <li><strong>Options possibles</strong></li>
        <li><strong>Plan d‚Äôaction</strong></li>
        <li><strong>Points de vigilance</strong></li>
      </ol>
      <div class="pro-answer">
        <!-- La r√©ponse g√©n√©r√©e par l‚ÄôIA s‚Äôaffichera ici -->
      </div>
    </section>

    <!-- Canadia Pro Exemple de R√©ponse Structur√©e Section -->
    <section class="response">
      <h3>Diagnostic</h3>
      <p>La structure actuelle montre un chevauchement des responsabilit√©s...</p>
      <h3>Options possibles</h3>
      <ul>
        <li>Clarifier les r√¥les</li>
        <li>Cr√©er un point de coordination</li>
      </ul>
    </section>

    <!-- Canadia Pro Plan d‚ÄôAction Propos√© Section -->
    <section class="action-plan">
      <h2>Plan d‚Äôaction propos√©</h2>
      <ol>
        <li>Clarifier les responsabilit√©s cl√©s</li>
        <li>Mettre en place une r√©union hebdomadaire</li>
        <li>Documenter les processus critiques</li>
      </ol>
    </section>

    <!-- Canadia Pro Historique des Analyses Section -->
    <section class="history">
      <h2>Historique</h2>
      <ul>
        <li>Analyse ‚Äì Communication interne (12 mai)</li>
        <li>Diagnostic ‚Äì Structure (8 mai)</li>
      </ul>
    </section>

    <!-- Disclaimer Canadia Pro -->
    <small class="disclaimer">
    Canadia Pro est un outil d‚Äôaide √† la structuration et √† la r√©flexion strat√©gique.
    Il ne fournit aucun conseil financier, fiscal ou juridique.
    </small>
</main>

<script src="main.js"></script>
</body>
</html>
